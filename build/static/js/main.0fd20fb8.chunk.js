(this["webpackJsonpreact-detached-portal-memory-leak"]=this["webpackJsonpreact-detached-portal-memory-leak"]||[]).push([[0],{10:function(e,t,n){"use strict";n.r(t);var c=n(2),r=n(1),l=n.n(r),o=(n(8),n(0));const u=l.a.lazy((()=>n.e(3).then(n.bind(null,11))));function d(){const[e,t]=l.a.useState(!1),[n,d]=l.a.useState("none"),a=l.a.useRef(null),i=l.a.useRef(null),s=l.a.useRef(null),j=l.a.useCallback(((e,n)=>{var c,r;a.current=window.open(e,"_blank","width=320,height=320"),i.current=document.createElement("div"),i.current.id="root",null===(c=a.current)||void 0===c||c.document.body.appendChild(i.current),null===(r=a.current)||void 0===r||r.addEventListener("pagehide",(()=>{n&&n(),i.current=null,a.current=null,t(!1)})),t(!0)}),[]),b=l.a.useCallback((()=>{var e;null===(e=a.current)||void 0===e||e.close()}),[]);return Object(o.jsxs)("div",{className:"App",children:[Object(o.jsx)("h1",{children:"Memory leak in detached React portal"}),Object(o.jsx)("button",{onClick:()=>{j(""),d("portal-in-window")},children:"OPEN WINDOW AND RENDER THROUGH PORTAL"}),Object(o.jsx)("button",{onClick:()=>{j("",(()=>{i.current&&Object(c.unmountComponentAtNode)(i.current)})),i.current&&(Object(c.render)(Object(o.jsx)(r.Suspense,{fallback:"...loading",children:Object(o.jsx)(u,{})}),i.current),d("react-tree-in-window"))},children:"OPEN WINDOW AND RENDER INDEPENDED REACT DOM TREE"}),Object(o.jsx)("button",{onClick:()=>{b(),d("none")},children:"CLOSE DETACHED WINDOW"}),Object(o.jsx)("div",{style:{height:16}}),Object(o.jsx)("button",{onClick:()=>{d("portal-embedded")},children:"RENDER THROUGH PORTAL HERE"}),Object(o.jsx)("button",{onClick:()=>{d("none")},children:"REMOVE EMBEDDED PORTAL"}),Object(o.jsx)("div",{style:{height:16}}),Object(o.jsx)("button",{onClick:()=>{s.current&&Object(c.render)(Object(o.jsx)(r.Suspense,{fallback:"...loading",children:Object(o.jsx)(u,{})}),s.current)},children:"RENDER INDEPENDED REACT DOM TREE HERE"}),Object(o.jsx)("button",{onClick:()=>{s.current&&Object(c.unmountComponentAtNode)(s.current)},children:"UNMOUNT INDEPENDED REACT DOM TREE HERE"}),Object(o.jsx)("div",{style:{height:16}}),Object(o.jsxs)(r.Suspense,{fallback:"...loading",children:["portal-in-window"===n&&e&&a.current&&i.current&&Object(c.createPortal)(Object(o.jsx)(u,{}),i.current),"portal-embedded"===n&&s.current&&Object(c.createPortal)(Object(o.jsx)(u,{}),s.current)]}),Object(o.jsx)("div",{ref:s})]})}const a=document.getElementById("root");Object(c.render)(Object(o.jsx)(d,{}),a)},8:function(e,t,n){}},[[10,1,2]]]);
//# sourceMappingURL=main.0fd20fb8.chunk.js.map